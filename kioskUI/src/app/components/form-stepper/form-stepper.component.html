<div class="outer-container">
<form [formGroup]="formGroup">
    <mat-stepper formArrayName="formArray" labelPosition="bottom" #stepper>
      <ng-container *ngFor="let step of stepperConfig; let index = index">
        <mat-step [formGroupName]="index" [stepControl]="formGroup.get('formArray')?.get([index])!">
          <div class="heading">{{ step.heading }}</div>
  
          <div *ngIf="step.contentType === 'form'" class="agent-container stepper-container">
            <ng-container *ngFor="let field of step.fields">
              <mat-label class="label">{{ field.label }}</mat-label>
              <mat-form-field appearance="outline">
                <ng-container [ngSwitch]="field.type">
                  <input *ngSwitchCase="'input'" matInput [placeholder]="field.placeholder" [formControlName]="field.controlName" [required]="field.required">
                  <mat-select *ngSwitchCase="'select'" [formControlName]="field.controlName">
                    <mat-option *ngFor="let option of field.options" [value]="option.value" [disabled]="option.disabled">{{ option.label }}</mat-option>
                  </mat-select>
                </ng-container>
              </mat-form-field>
            </ng-container>
          </div>
  
          <div *ngIf="step.contentType === 'options'" class="stepper-container">
            <div class="runtime-container">
              <div class="option-selectors">
                <div class="example-radio-group">
                    <div 
                      *ngFor="let option of step.options"
                      [ngClass]="{'selected': option.isSelected}" 
                      (click)="onRadioChange(step, option)" 
                      class="option-card">
                      <span class="icon">
                        <span class="material-symbols-outlined">{{ option.isSelected ? 'task_alt' : 'radio_button_unchecked' }}</span>
                      </span>
                      <span class="text">{{ option.label }}</span>
                    </div>
                  </div>
              </div>
              <div *ngIf="step.selectedOptionResponse" class="option-response">
                <span class="subtitle">{{ step.selectedOptionResponse.subtitle }}</span>
                <span class="caption">{{ step.selectedOptionResponse.caption }}</span>
              </div>
            </div>
          </div>
  
          <div class="footer-container">
            <button *ngIf="step.hasHome" class="home" mat-fab extended (click)="step.onHomeClick()">
              <mat-icon>home</mat-icon>
              Home
            </button>
            <div class="button-container">
              <button *ngIf="step.hasPrevious" class="backward" mat-fab extended matStepperPrevious>
                <mat-icon>arrow_back</mat-icon>
                Back
              </button>
              <button *ngIf="step.hasNext" mat-fab extended matStepperNext>
                <mat-icon>arrow_forward</mat-icon>
                Next
              </button>
              <button *ngIf="step.hasSubmit" mat-fab extended (click)="goToSpinnerComponent()">
                <mat-icon>arrow_forward</mat-icon>
                Submit
              </button>
              <button *ngIf="step.hasExport" class="export" mat-fab extended>
                <mat-icon>file_export</mat-icon>
                Export
              </button>
              <button *ngIf="step.hasReset" mat-fab extended>
                <mat-icon>settings_backup_restore</mat-icon>
                Start Again
              </button>
            </div>
          </div>
        </mat-step>
      </ng-container>
    </mat-stepper>
  </form>
</div>
  